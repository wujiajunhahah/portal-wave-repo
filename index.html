<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DreamEcho | æ¢¦å¢ƒ 3D æ¨¡å‹</title>

    <!-- Three.js æ¨¡å—å¯¼å…¥ -->
    <script async src="https://unpkg.com/es-module-shims@1.8.0/dist/es-module-shims.js"></script>
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.150.1/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.150.1/examples/jsm/"
        }
    }
    </script>

    <style>
        /* CSS å˜é‡å®šä¹‰ */
        :root {
            --main-bg: #0b1423;
            --highlight: #00d6ff;
            --accent: #1a2b45;
            --text: #ffffffcc;
            --radius: 20px;
            --shadow: 0 8px 32px 0 rgba(0, 214, 255, 0.1);
            --card-bg: rgba(26, 43, 69, 0.4);
            --badge-bg: rgba(0, 214, 255, 0.1);
            --btn-gradient: linear-gradient(135deg, #00d6ff 0%, #0b1423 100%);
        }

        /* åŠ¨ç”»å®šä¹‰ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes glow {
            0% { box-shadow: 0 0 5px rgba(0, 214, 255, 0.2); }
            50% { box-shadow: 0 0 20px rgba(0, 214, 255, 0.4); }
            100% { box-shadow: 0 0 5px rgba(0, 214, 255, 0.2); }
        }

        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0); }
        }

        /* åŸºç¡€æ ·å¼ */
        html, body {
            margin: 0;
            padding: 0;
            background: var(--main-bg);
            color: var(--text);
            font-family: system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(0, 214, 255, 0.1), transparent 70%),
                        radial-gradient(circle at bottom left, rgba(0, 214, 255, 0.05), transparent 70%);
            pointer-events: none;
            z-index: -1;
        }

        /* æ ‡é¢˜æ ·å¼ */
        h1 {
            text-align: center;
            font-size: 2.8rem;
            font-weight: 800;
            color: var(--highlight);
            margin: 2rem 0;
            letter-spacing: -0.5px;
            animation: float 6s ease-in-out infinite;
            text-shadow: 0 0 20px rgba(0, 214, 255, 0.3);
        }

        /* å®¹å™¨å’ŒæŸ¥çœ‹å™¨ */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 2rem;
            animation: fadeIn 1s ease-out;
        }

        #viewer {
            width: 100%;
            height: 60vh;
            background: var(--accent);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
            animation: glow 4s infinite;
        }

        /* å¡ç‰‡æ ·å¼ */
        .card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 214, 255, 0.1);
            border-radius: var(--radius);
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 214, 255, 0.2);
        }

        /* å…³é”®è¯å¾½ç«  */
        .keywords {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
            margin: 1rem 0;
        }

        .badge {
            background: var(--badge-bg);
            color: var(--highlight);
            padding: 0.8rem 1.5rem;
            border-radius: calc(var(--radius) / 2);
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            border: 1px solid rgba(0, 214, 255, 0.2);
            cursor: pointer;
        }

        .badge:hover {
            background: rgba(0, 214, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 214, 255, 0.2);
        }

        /* æŒ‰é’®æ ·å¼ */
        .btn {
            background: var(--btn-gradient);
            color: #fff;
            border: none;
            padding: 1rem 2rem;
            border-radius: calc(var(--radius) / 2);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: translateX(-100%);
            transition: 0.5s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 214, 255, 0.3);
        }

        .btn:hover::before {
            transform: translateX(100%);
        }

        /* æè¿°å’Œåˆ†ææ ·å¼ */
        .description {
            font-size: 1.2rem;
            line-height: 1.8;
            color: var(--text);
            margin: 1rem 0;
        }

        .analysis {
            position: relative;
            padding: 1.5rem;
            margin: 1rem 0;
            border-left: 4px solid var(--highlight);
            background: rgba(0, 214, 255, 0.05);
            border-radius: 0 var(--radius) var(--radius) 0;
        }

        /* åŠ è½½åŠ¨ç”» */
        #loading {
            position: fixed;
            inset: 0;
            background: rgba(11, 20, 35, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .loading-content {
            text-align: center;
            animation: fadeIn 0.5s ease-out;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 3px solid var(--highlight);
            border-top: 3px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        .loading-text {
            color: var(--highlight);
            font-size: 1.2rem;
            margin-top: 1rem;
        }

        .loading-progress {
            color: var(--highlight);
            font-size: 1.5rem;
            font-weight: bold;
            margin-top: 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Logo æ ·å¼ */
        .logo {
            position: fixed;
            top: 2rem;
            left: 2rem;
            width: 80px;
            height: 80px;
            z-index: 10;
            transition: all 0.3s ease;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: drop-shadow(0 0 10px rgba(0, 214, 255, 0.3));
        }

        /* åˆ›ä½œè€…å¡ç‰‡ */
        .creator-card {
            position: absolute;
            left: 1rem;
            bottom: 1rem;
            background: rgba(0, 214, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 1rem;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            gap: 1rem;
            border: 1px solid rgba(0, 214, 255, 0.2);
            z-index: 10;
            transition: all 0.3s ease;
        }

        .creator-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 214, 255, 0.2);
        }

        .creator-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid var(--highlight);
        }

        .creator-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .creator-info {
            display: flex;
            flex-direction: column;
        }

        .creator-name {
            color: var(--highlight);
            font-weight: 600;
            font-size: 1rem;
            margin: 0;
        }

        .creator-title {
            color: var(--text);
            font-size: 0.8rem;
            opacity: 0.8;
        }

        /* äº¤äº’æŒ‰é’® */
        .interaction-buttons {
            position: absolute;
            right: 1rem;
            bottom: 1rem;
            display: flex;
            gap: 1rem;
            z-index: 10;
        }

        .interaction-btn {
            background: rgba(0, 214, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 214, 255, 0.2);
            border-radius: var(--radius);
            padding: 0.5rem 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--highlight);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .interaction-btn:hover {
            transform: translateY(-2px);
            background: rgba(0, 214, 255, 0.2);
            box-shadow: 0 5px 15px rgba(0, 214, 255, 0.2);
        }

        /* ç»Ÿè®¡ä¿¡æ¯ */
        .viewer-stats {
            position: absolute;
            bottom: 1rem;
            right: 1rem;
            background: rgba(0, 214, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border: 1px solid rgba(0, 214, 255, 0.2);
            z-index: 10;
        }

        .eye-icon {
            width: 24px;
            height: 24px;
            stroke: var(--highlight);
            fill: none;
            stroke-width: 2;
        }

        .stats-number {
            color: var(--highlight);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .interaction-stats {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--highlight);
            font-size: 0.9rem;
            margin-left: 0.5rem;
        }

        .btn-with-stats {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stats-count {
            color: var(--highlight);
            font-weight: 600;
        }

        .follow-btn {
            background: var(--highlight);
            color: var(--main-bg);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: calc(var(--radius) / 2);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .follow-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 214, 255, 0.3);
        }

        /* Toast æç¤º */
        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: rgba(0, 214, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            border-radius: var(--radius);
            border: 1px solid rgba(0, 214, 255, 0.2);
            color: var(--highlight);
            font-weight: 600;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .toast-icon {
            font-size: 1.2rem;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .logo {
                width: 60px;
                height: 60px;
                top: 1rem;
                left: 1rem;
            }

            .creator-card {
                left: 1rem;
                right: 1rem;
                width: auto;
                transform: none;
                bottom: 5rem;
            }

            .interaction-buttons {
                left: 1rem;
                right: 1rem;
                transform: none;
                bottom: 1rem;
                justify-content: center;
            }

            .viewer-stats {
                top: 1rem;
                right: 1rem;
                bottom: auto;
            }

            h1 {
                font-size: 2rem;
                margin: 1rem 0;
            }

            .container {
                padding: 0 1rem;
            }

            #viewer {
                height: 50vh;
            }
        }
        /* è¯­è¨€åˆ‡æ¢æŒ‰é’® */
        .language-switcher {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 214, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 214, 255, 0.2);
            border-radius: 25px;
            padding: 0.5rem;
            display: flex;
            gap: 0.5rem;
            z-index: 100;
            transition: all 0.3s ease;
        }

        .language-switcher:hover {
            transform: translateX(-50%) translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 214, 255, 0.2);
        }

        .lang-btn {
            background: transparent;
            border: none;
            color: var(--text);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .lang-btn.active {
            background: var(--highlight);
            color: var(--main-bg);
            font-weight: 600;
        }

        .lang-btn:hover:not(.active) {
            background: rgba(0, 214, 255, 0.2);
            color: var(--highlight);
        }
    </style>
</head>
<body>
    <!-- åŠ è½½ç•Œé¢ -->
    <div id="loading">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text" data-i18n="loading">æ­£åœ¨åŠ è½½æ¢¦å¢ƒ...</div>
            <div class="loading-progress">0%</div>
        </div>
    </div>

    <!-- Toast æç¤º -->
    <div id="toast" class="toast"></div>

    <!-- Logo -->
    <a href="/" class="logo">
        <img src="dreamecho_logo.png" alt="DreamEcho Logo">
    </a>

    <!-- ä¸»æ ‡é¢˜ -->
    <h1 data-i18n="title">æ¢¦å¢ƒï¼šç”µæ¢¯ Â· æµ·æµª</h1>

    <!-- ä¸»è¦å†…å®¹å®¹å™¨ -->
    <div class="container">
        <!-- 3D æ¨¡å‹æŸ¥çœ‹å™¨ -->
        <div id="viewer">
            <!-- æµè§ˆç»Ÿè®¡ -->
            <div class="viewer-stats">
                <svg class="eye-icon" viewBox="0 0 24 24">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                </svg>
                <span class="stats-number">1,948</span>
            </div>

            <!-- åˆ›ä½œè€…ä¿¡æ¯å¡ç‰‡ -->
            <div class="creator-card">
                <div class="creator-avatar">
                    <img src="IMG_1141.jpeg" alt="å´å˜‰ä¿Šçš„å¤´åƒ">
                </div>
                <div class="creator-info">
                    <div class="creator-name" data-i18n="creatorName">å´å˜‰ä¿Š</div>
                    <div class="creator-title" data-i18n="creatorTitle">å­¦ç”Ÿ</div>
                </div>
                <button class="follow-btn" onclick="showToast(i18nData[currentLang].followSuccess)">
                    <span data-i18n="follow">å…³æ³¨</span>
                </button>
            </div>

            <!-- äº¤äº’æŒ‰é’® -->
            <div class="interaction-buttons">
                <div class="interaction-btn" onclick="showToast(i18nData[currentLang].likeSuccess)">
                    <span data-i18n="like">ç‚¹èµ</span>
                    <span class="stats-count">3.1k</span>
                </div>
                <div class="interaction-btn" onclick="downloadModel()">
                    <span>ğŸ“¥</span>
                    <span data-i18n="downloadModel">ä¸‹è½½æ¨¡å‹</span>
                </div>
            </div>
        </div>

        <!-- å…³é”®è¯å¡ç‰‡ -->
        <div class="card">
            <div class="keywords">
                <span class="badge" data-i18n="keyword1">ç”µæ¢¯</span>
                <span class="badge" data-i18n="keyword2">æµ·æµª</span>
                <span class="badge" data-i18n="keyword3">æœªçŸ¥ç©ºé—´</span>
                <span class="badge" data-i18n="keyword4">ææƒ§</span>
                <span class="badge" data-i18n="keyword5">çªç ´</span>
                <span class="badge" data-i18n="keyword6">ä¸–ç•Œå…¥å£</span>
            </div>
        </div>

        <!-- æ¢¦å¢ƒæè¿°å¡ç‰‡ -->
        <div class="card">
            <strong data-i18n="dreamDescription">æ¢¦å¢ƒæè¿°</strong>
            <p class="description" data-i18n="dreamContent">æˆ‘åšäº†ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„æ¢¦ã€‚æˆ‘èµ°è¿›ä¸€éƒ¨ç”µæ¢¯ï¼Œæœ¬æ¥åªæ˜¯æƒ³å»æ¥¼ä¸‹ï¼Œä½†é—¨ä¸€å…³ä¸Šï¼Œæ•´ä¸ªç©ºé—´çªç„¶å˜å¾—å¼‚å¸¸å®‰é™ã€‚ä¸‹ä¸€ç§’ï¼Œç”µæ¢¯é—¨ç¼“ç¼“æ‰“å¼€ï¼Œä¸€é“å·¨å¤§çš„è“è‰²æµ·æµªæ­£å†²ç€æˆ‘å·ä¸Šæ¥ï¼Œåƒæ˜¯æŸç§"æ´»"çš„ä¸œè¥¿ï¼Œå¸¦ç€å…‰ã€å¸¦ç€è„‰åŠ¨ï¼Œåƒæ˜¯åœ¨å‘¼å¸ã€‚å®ƒæ²¡æœ‰çœŸæ­£æ‹åˆ°æˆ‘ï¼Œä½†æˆ‘èƒ½æ„Ÿè§‰åˆ°ä¸€è‚¡åŠ›é‡åœ¨æŠŠæˆ‘å¾€å‰æ‹‰ï¼Œå¥½åƒå®ƒæƒ³è®©æˆ‘è¿›å»ã€‚æˆ‘è®°å¾—è‡ªå·±ç«™åœ¨é—¨å£ä¸æ•¢åŠ¨ï¼Œæ—¢å®³æ€•åˆè«åå…´å¥‹ï¼Œå°±åƒç«™åœ¨ä¸€ä¸ªå…¨æ–°çš„ä¸–ç•Œå…¥å£å‰ã€‚</p>
        </div>

        <!-- æ¢¦å¢ƒè§£æå¡ç‰‡ -->
        <div class="card">
            <strong data-i18n="dreamAnalysis">æ¢¦å¢ƒè§£æ</strong>
            <div class="analysis" data-i18n="analysisContent">
                è¿™ä¸ªæ¢¦è±¡å¾ç€è½¬å˜ã€å‹åŠ›ä¸æ½œæ„è¯†çš„å¬å”¤ã€‚ç”µæ¢¯é€šå¸¸ä»£è¡¨"çŠ¶æ€æ”¹å˜"æˆ–"å†…åœ¨ä½ç½®çš„ç§»åŠ¨"ã€‚æµ·æµªè±¡å¾æƒ…ç»ªã€æ½œæ„è¯†ä»¥åŠæ— æ³•æ§åˆ¶çš„å¤–éƒ¨åŠ›é‡ã€‚æµ·æµªå‘ä½ "é è¿‘ä½†æœªæ·¹æ²¡"ï¼Œæ„å‘³ç€ä½ æ­£åœ¨é¢å¯¹æŸç§å·¨å¤§çš„å˜åŒ–ï¼Œä½†ä»å¤„åœ¨å¯ä»¥æŒæ§çš„è¾¹ç¼˜ã€‚è¿™ç§æ—¢å®³æ€•åˆå…´å¥‹çš„æ„Ÿè§‰ï¼Œåæ˜ äº†ä½ å¯¹æœªçŸ¥é¢†åŸŸçš„æœŸå¾… â€”â€” å¾ˆå¯èƒ½ä¸ä½ è¿‘æœŸçš„é¡¹ç›®ã€æœªæ¥è§„åˆ’æˆ–äººç”Ÿé€‰æ‹©æœ‰å…³ã€‚æ¢¦æ­£åœ¨æ¨åŠ¨ä½ å‘å‰ï¼Œè®©ä½ è·¨å…¥ä¸€ä¸ªæ–°çš„é˜¶æ®µã€‚
            </div>
        </div>

        <!-- è¿›å…¥ App æŒ‰é’® -->
        <div class="card" style="text-align: center">
            <button class="btn" onclick="window.open('https://yourapp.link/download')" data-i18n="enterApp">è¿›å…¥ App</button>
        </div>
    </div>

    <!-- è¯­è¨€åˆ‡æ¢æŒ‰é’® -->
    <div class="language-switcher">
        <button class="lang-btn active" onclick="switchLanguage('zh')">ä¸­æ–‡</button>
        <button class="lang-btn" onclick="switchLanguage('en')">English</button>
    </div>

    <!-- Toast æ˜¾ç¤ºå‡½æ•° -->
    <script>
        // å›½é™…åŒ–è¯­è¨€åŒ…
        const i18nData = {
            zh: {
                loading: "æ­£åœ¨åŠ è½½æ¢¦å¢ƒ...",
                title: "æ¢¦å¢ƒï¼šç”µæ¢¯ Â· æµ·æµª",
                creatorName: "å´å˜‰ä¿Š",
                creatorTitle: "å­¦ç”Ÿ",
                follow: "å…³æ³¨",
                followSuccess: "âœ¨ å…³æ³¨æˆåŠŸ",
                like: "ç‚¹èµ",
                likeSuccess: "â¤ï¸ ç‚¹èµæˆåŠŸ",
                downloadModel: "ä¸‹è½½æ¨¡å‹",
                keyword1: "ç”µæ¢¯",
                keyword2: "æµ·æµª",
                keyword3: "æœªçŸ¥ç©ºé—´",
                keyword4: "ææƒ§",
                keyword5: "çªç ´",
                keyword6: "ä¸–ç•Œå…¥å£",
                dreamDescription: "æ¢¦å¢ƒæè¿°",
                dreamContent: "æˆ‘åšäº†ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„æ¢¦ã€‚æˆ‘èµ°è¿›ä¸€éƒ¨ç”µæ¢¯ï¼Œæœ¬æ¥åªæ˜¯æƒ³å»æ¥¼ä¸‹ï¼Œä½†é—¨ä¸€å…³ä¸Šï¼Œæ•´ä¸ªç©ºé—´çªç„¶å˜å¾—å¼‚å¸¸å®‰é™ã€‚ä¸‹ä¸€ç§’ï¼Œç”µæ¢¯é—¨ç¼“ç¼“æ‰“å¼€ï¼Œä¸€é“å·¨å¤§çš„è“è‰²æµ·æµªæ­£å†²ç€æˆ‘å·ä¸Šæ¥ï¼Œåƒæ˜¯æŸç§'æ´»'çš„ä¸œè¥¿ï¼Œå¸¦ç€å…‰ã€å¸¦ç€è„‰åŠ¨ï¼Œåƒæ˜¯åœ¨å‘¼å¸ã€‚å®ƒæ²¡æœ‰çœŸæ­£æ‹åˆ°æˆ‘ï¼Œä½†æˆ‘èƒ½æ„Ÿè§‰åˆ°ä¸€è‚¡åŠ›é‡åœ¨æŠŠæˆ‘å¾€å‰æ‹‰ï¼Œå¥½åƒå®ƒæƒ³è®©æˆ‘è¿›å»ã€‚æˆ‘è®°å¾—è‡ªå·±ç«™åœ¨é—¨å£ä¸æ•¢åŠ¨ï¼Œæ—¢å®³æ€•åˆè«åå…´å¥‹ï¼Œå°±åƒç«™åœ¨ä¸€ä¸ªå…¨æ–°çš„ä¸–ç•Œå…¥å£å‰ã€‚",
                dreamAnalysis: "æ¢¦å¢ƒè§£æ",
                analysisContent: "è¿™ä¸ªæ¢¦è±¡å¾ç€è½¬å˜ã€å‹åŠ›ä¸æ½œæ„è¯†çš„å¬å”¤ã€‚ç”µæ¢¯é€šå¸¸ä»£è¡¨'çŠ¶æ€æ”¹å˜'æˆ–'å†…åœ¨ä½ç½®çš„ç§»åŠ¨'ã€‚æµ·æµªè±¡å¾æƒ…ç»ªã€æ½œæ„è¯†ä»¥åŠæ— æ³•æ§åˆ¶çš„å¤–éƒ¨åŠ›é‡ã€‚æµ·æµªå‘ä½ 'é è¿‘ä½†æœªæ·¹æ²¡'ï¼Œæ„å‘³ç€ä½ æ­£åœ¨é¢å¯¹æŸç§å·¨å¤§çš„å˜åŒ–ï¼Œä½†ä»å¤„åœ¨å¯ä»¥æŒæ§çš„è¾¹ç¼˜ã€‚è¿™ç§æ—¢å®³æ€•åˆå…´å¥‹çš„æ„Ÿè§‰ï¼Œåæ˜ äº†ä½ å¯¹æœªçŸ¥é¢†åŸŸçš„æœŸå¾… â€”â€” å¾ˆå¯èƒ½ä¸ä½ è¿‘æœŸçš„é¡¹ç›®ã€æœªæ¥è§„åˆ’æˆ–äººç”Ÿé€‰æ‹©æœ‰å…³ã€‚æ¢¦æ­£åœ¨æ¨åŠ¨ä½ å‘å‰ï¼Œè®©ä½ è·¨å…¥ä¸€ä¸ªæ–°çš„é˜¶æ®µã€‚",
                enterApp: "è¿›å…¥ App",
                downloadInfo: "ğŸ“¥ æ¨¡å‹æ–‡ä»¶è·å–æ–¹å¼ï¼š\n1. è”ç³»ä½œè€…è·å–å®Œæ•´ .glb æ–‡ä»¶\n2. æˆ–é€šè¿‡äº‘ç›˜é“¾æ¥ä¸‹è½½\n3. æ”¯æŒARæŸ¥çœ‹çš„å®Œæ•´3Dæ¨¡å‹",
                modelLoadError: "âŒ GLBæ¨¡å‹åŠ è½½å¤±è´¥ï¼š",
                modelFileNotFound: "âŒ æ— æ³•æ‰¾åˆ°GLBæ¨¡å‹æ–‡ä»¶ï¼Œè¯·ç¡®ä¿'ç”µæ¢¯.glb'æ–‡ä»¶åœ¨æ­£ç¡®çš„ä½ç½®"
            },
            en: {
                loading: "Loading dream...",
                title: "Dream: Elevator & Waves",
                creatorName: "Wu Jiajun",
                creatorTitle: "Student",
                follow: "Follow",
                followSuccess: "âœ¨ Followed successfully",
                like: "Like",
                likeSuccess: "â¤ï¸ Liked successfully",
                downloadModel: "Download Model",
                keyword1: "Elevator",
                keyword2: "Waves",
                keyword3: "Unknown Space",
                keyword4: "Fear",
                keyword5: "Breakthrough",
                keyword6: "World Entrance",
                dreamDescription: "Dream Description",
                dreamContent: "I had a very strange dream. I walked into an elevator, originally just wanting to go downstairs, but as soon as the door closed, the entire space became unusually quiet. The next second, the elevator door slowly opened, and a huge blue wave was rolling towards me, like something 'alive', with light and pulsation, as if breathing. It didn't actually hit me, but I could feel a force pulling me forward, as if it wanted me to enter. I remembered standing at the door, unable to move, both scared and strangely excited, as if standing at the entrance to a whole new world.",
                dreamAnalysis: "Dream Analysis",
                analysisContent: "This dream symbolizes transformation, pressure, and the call of the subconscious. Elevators usually represent 'state change' or 'internal position movement'. Waves symbolize emotions, subconscious, and uncontrollable external forces. The wave 'approached but didn't submerge' you, meaning you are facing some huge change, but still on the edge of control. This feeling of both fear and excitement reflects your anticipation for the unknown â€” likely related to your recent projects, future plans, or life choices. The dream is pushing you forward, letting you step into a new stage.",
                enterApp: "Enter App",
                downloadInfo: "ğŸ“¥ Model file access:\n1. Contact author for complete .glb file\n2. Or download via cloud link\n3. Complete 3D model supporting AR viewing",
                modelLoadError: "âŒ GLB model loading failed:",
                modelFileNotFound: "âŒ Unable to find GLB model file, please ensure 'elevator.glb' is in the correct location"
            }
        };

        // å½“å‰è¯­è¨€
        let currentLang = localStorage.getItem('preferredLanguage') || 'zh';

        // è¯­è¨€åˆ‡æ¢å‡½æ•°
        function switchLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('preferredLanguage', lang);

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // æ›´æ–°HTML langå±æ€§
            document.documentElement.lang = lang === 'zh' ? 'zh' : 'en';

            // æ›´æ–°æ‰€æœ‰å¸¦æœ‰data-i18nå±æ€§çš„å…ƒç´ 
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (i18nData[lang][key]) {
                    element.textContent = i18nData[lang][key];
                }
            });
        }

        // åˆå§‹åŒ–è¯­è¨€
        function initLanguage() {
            // è®¾ç½®åˆå§‹è¯­è¨€æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if ((btn.textContent === 'ä¸­æ–‡' && currentLang === 'zh') ||
                    (btn.textContent === 'English' && currentLang === 'en')) {
                    btn.classList.add('active');
                }
            });

            // åº”ç”¨åˆå§‹è¯­è¨€
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (i18nData[currentLang][key]) {
                    element.textContent = i18nData[currentLang][key];
                }
            });

            // è®¾ç½®HTML langå±æ€§
            document.documentElement.lang = currentLang === 'zh' ? 'zh' : 'en';
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }

        function downloadModel() {
            showToast(i18nData[currentLang].downloadInfo);
        }
    </script>

    <!-- Three.js 3D æ¸²æŸ“è„šæœ¬ -->
    <script type="module">
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        // åˆ›å»ºåœºæ™¯ã€ç›¸æœºå’Œæ¸²æŸ“å™¨
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / (window.innerHeight * 0.6), 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });

        renderer.setSize(window.innerWidth, window.innerHeight * 0.6);
        document.getElementById('viewer').appendChild(renderer.domElement);

        // åˆ›å»º OrbitControls
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.screenSpacePanning = true;
        controls.minDistance = 1;
        controls.maxDistance = 10;
        controls.maxPolarAngle = Math.PI / 1.5;

        // åŒå‡»é‡ç½®è§†è§’
        renderer.domElement.addEventListener('dblclick', () => {
            camera.position.set(0, 1.5, 5);
            controls.target.set(0, 0, 0);
            controls.update();
        });

        // æ·»åŠ æµ‹è¯•ç”¨ç«‹æ–¹ä½“
        const testGeometry = new THREE.BoxGeometry(1, 1, 1);
        const testMaterial = new THREE.MeshStandardMaterial({ color: 0x00ccff });
        const testCube = new THREE.Mesh(testGeometry, testMaterial);
        scene.add(testCube);

        // æ·»åŠ ç¯å…‰
        const light = new THREE.DirectionalLight(0xffffff, 1);
        light.position.set(2, 2, 5);
        scene.add(light);
        scene.add(new THREE.AmbientLight(0x404040));
        scene.add(new THREE.HemisphereLight(0xffffff, 0x444444, 0.5));

        // è®¾ç½®åŠ è½½ç®¡ç†å™¨
        const loadingManager = new THREE.LoadingManager();
        const loading = document.getElementById('loading');
        const progressElement = document.querySelector('.loading-progress');

        // ä½¿ç”¨ç¼“å­˜åŠ è½½å™¨
        THREE.Cache.enabled = true;

        loadingManager.onStart = function(url, itemsLoaded, itemsTotal) {
            loading.style.display = 'flex';
            document.body.style.cursor = 'wait';
        };

        loadingManager.onProgress = function(url, loaded, total) {
            const progress = (loaded / total * 100).toFixed(0);
            if (progressElement) {
                progressElement.textContent = `${progress}%`;
            }
        };

        loadingManager.onLoad = function() {
            loading.style.display = 'none';
            document.body.style.cursor = 'default';
        };

        loadingManager.onError = function(url) {
            loading.style.display = 'none';
            document.body.style.cursor = 'default';
            console.error('åŠ è½½å¤±è´¥:', url);
        };

        // ä¼˜åŒ–æ¸²æŸ“å™¨è®¾ç½®
        renderer.setPixelRatio(window.devicePixelRatio > 1 ? 2 : 1);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;

        // ä¼˜åŒ–æè´¨è®¾ç½®
        const material = new THREE.MeshStandardMaterial({
            color: 0x00ccff,
            metalness: 0.4,
            roughness: 0.3,
            envMapIntensity: 1.0,
            flatShading: true
        });

        // åˆ›å»ºç¯å¢ƒè´´å›¾
        const pmremGenerator = new THREE.PMREMGenerator(renderer);
        pmremGenerator.compileEquirectangularShader();

        // ä½¿ç”¨åŸæ¨¡æ¿çš„æ–‡ä»¶æ£€æŸ¥æœºåˆ¶åŠ è½½GLBæ¨¡å‹
        fetch('ç”µæ¢¯.glb')
          .then(response => {
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            console.log('GLBæ–‡ä»¶å­˜åœ¨ï¼Œå¼€å§‹åŠ è½½æ¨¡å‹');

            // å°è¯•ä½¿ç”¨ç¼“å­˜
            const modelCache = localStorage.getItem('elevatorModelCache');
            if (modelCache) {
              console.log('ä½¿ç”¨ç¼“å­˜çš„æ¨¡å‹æ•°æ®');
              const gltfLoader = new GLTFLoader(loadingManager);
              try {
                const gltf = gltfLoader.parse(modelCache);
                setupModel(gltf.scene);
                return;
              } catch (e) {
                console.warn('ç¼“å­˜è§£æå¤±è´¥:', e);
              }
            }

            // åˆ›å»ºGLTFåŠ è½½å™¨å¹¶åŠ è½½GLBæ¨¡å‹
            const gltfLoader = new GLTFLoader(loadingManager);
            gltfLoader.load('ç”µæ¢¯.glb',
                function (gltf) {
                    console.log('GLBæ¨¡å‹åŠ è½½æˆåŠŸï¼');

                    // ç¼“å­˜æ¨¡å‹æ•°æ®
                    try {
                        // å°†gltfå¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²å­˜å‚¨
                        const modelJson = JSON.stringify(gltf.scene.toJSON());
                        localStorage.setItem('elevatorModelCache', modelJson);
                    } catch (e) {
                        console.warn('æ¨¡å‹ç¼“å­˜å¤±è´¥:', e);
                    }

                    setupModel(gltf.scene);
                },
                function (xhr) {
                    const percent = (xhr.loaded / xhr.total * 100).toFixed(0);
                    if (progressElement) {
                        progressElement.textContent = `${percent}%`;
                    }
                    console.log(percent + '% å·²åŠ è½½');
                },
                function (error) {
                    console.error('GLBæ¨¡å‹åŠ è½½é”™è¯¯ï¼š', error);
                    alert(i18nData[currentLang].modelLoadError + error.message);
                    createFallbackModel();
                }
            );
          })
          .catch(error => {
            console.error('GLBæ–‡ä»¶æ£€æŸ¥å¤±è´¥ï¼š', error);
            alert(i18nData[currentLang].modelFileNotFound);
            createFallbackModel();
          });

        // å¤‡ç”¨æ¼”ç¤ºæ¨¡å‹ - ç”µæ¢¯å’Œæµ·æµªä¸»é¢˜
        function createFallbackModel() {
            console.log('æ˜¾ç¤ºç”µæ¢¯æµ·æµªæ¼”ç¤º');

            // åˆ›å»ºç”µæ¢¯ç«‹æ–¹ä½“
            const elevatorGeometry = new THREE.BoxGeometry(2, 3, 2);
            const elevatorMaterial = new THREE.MeshStandardMaterial({
                color: 0x666666,
                metalness: 0.8,
                roughness: 0.2
            });
            const elevator = new THREE.Mesh(elevatorGeometry, elevatorMaterial);
            scene.add(elevator);

            // åˆ›å»ºæµ·æµªæ•ˆæœ
            const waveGeometry = new THREE.PlaneGeometry(10, 6, 32, 16);
            const waveMaterial = new THREE.MeshStandardMaterial({
                color: 0x0099ff,
                metalness: 0.3,
                roughness: 0.4,
                transparent: true,
                opacity: 0.7,
                side: THREE.DoubleSide
            });
            const wave = new THREE.Mesh(waveGeometry, waveMaterial);
            wave.position.z = -3;
            scene.add(wave);

            // ç§»é™¤æµ‹è¯•ç«‹æ–¹ä½“
            scene.remove(testCube);

            // è®¾ç½®ç›¸æœºä½ç½®
            camera.position.set(6, 3, 6);
            controls.target.set(0, 0, 0);
            controls.update();

            // æ·»åŠ ç”µæ¢¯å’Œæµ·æµªåŠ¨ç”»
            function animateElevatorWave() {
                const time = Date.now() * 0.001;

                // æµ·æµªåŠ¨ç”»
                const positions = wave.geometry.attributes.position;
                for (let i = 0; i < positions.count; i++) {
                    const x = positions.getX(i);
                    const y = positions.getY(i);
                    const waveHeight = Math.sin(x * 0.5 + time * 2) * 0.3;
                    positions.setZ(i, waveHeight);
                }
                positions.needsUpdate = true;
                wave.geometry.computeVertexNormals();

                // ç”µæ¢¯è½»å¾®éœ‡åŠ¨
                elevator.position.y = Math.sin(time * 4) * 0.05;
            }

            // åœ¨åŠ¨ç”»å¾ªç¯ä¸­è°ƒç”¨
            function animate() {
                frameId = requestAnimationFrame(animate);

                animateElevatorWave();

                if (controls.enabled && controls.update) {
                    controls.update();
                }

                renderer.render(scene, camera);
            }

            // å¯åŠ¨åŠ¨ç”»
            animate();
        }

        // éšè—åŠ è½½ç•Œé¢
        setTimeout(() => {
            loading.style.display = 'none';
            document.body.style.cursor = 'default';

            // æ˜¾ç¤ºæ¨¡å‹ä¸‹è½½æç¤º
            showToast(i18nData[currentLang].downloadInfo);
        }, 1000);

        // æ¨¡å‹è®¾ç½®å‡½æ•°
        function setupModel(object) {
            const box = new THREE.Box3().setFromObject(object);
            const size = box.getSize(new THREE.Vector3());
            const center = box.getCenter(new THREE.Vector3());
            const maxDim = Math.max(size.x, size.y, size.z);
            const scale = 2 / maxDim;

            object.scale.multiplyScalar(scale);
            object.position.sub(center.multiplyScalar(scale));

            object.traverse(function(child) {
                if (child instanceof THREE.Mesh) {
                    child.material = material;
                    child.castShadow = true;
                    child.receiveShadow = true;

                    // ä¼˜åŒ–å‡ ä½•ä½“
                    if (child.geometry) {
                        child.geometry.computeVertexNormals();
                        child.geometry.computeBoundingSphere();
                        child.geometry.computeBoundingBox();
                    }
                }
            });

            scene.remove(testCube);
            scene.add(object);

            // ä¼˜åŒ–ç›¸æœºä½ç½®
            const distance = maxDim * 2;
            camera.position.set(distance, distance/2, distance);
            controls.target.set(0, 0, 0);
            controls.update();
        }

        // ä¼˜åŒ–åŠ¨ç”»å¾ªç¯
        let frameId;
        function animate() {
            frameId = requestAnimationFrame(animate);

            // åªåœ¨éœ€è¦æ—¶æ›´æ–°æ§åˆ¶å™¨
            if (controls.enabled && controls.update) {
                controls.update();
            }

            renderer.render(scene, camera);
        }

        // ä¼˜åŒ–çª—å£è°ƒæ•´
        let resizeTimeout;
        window.addEventListener('resize', () => {
            if (resizeTimeout) {
                clearTimeout(resizeTimeout);
            }
            resizeTimeout = setTimeout(() => {
                camera.aspect = window.innerWidth / (window.innerHeight * 0.6);
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight * 0.6);
            }, 250);
        });

        animate();
    </script>

    <!-- é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–è¯­è¨€ -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            initLanguage();
        });
    </script>
</body>
</html>